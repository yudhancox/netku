<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title><%= shortPlayName %> - Detail</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="//unpkg.com/xgplayer@3.0.14/dist/index.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
<script src="//unpkg.com/xgplayer@3.0.14/dist/index.min.js"></script>

<style>
body { overflow-x: hidden; }
.episode-card.active { background:#ec4899;color:#fff;font-weight:bold; }
.no-scrollbar::-webkit-scrollbar{display:none}
#player-container{aspect-ratio:16/9;background:#000;position:relative}
#subtitle{position:absolute;width:100%;text-align:center;pointer-events:none;z-index:50}
.mobile-controls-overlay{position:absolute;right:0;bottom:1rem;z-index:100}
.btn-custom-ply{background:rgba(0,0,0,.5);border-radius:9999px;padding:.6rem}
</style>
</head>

<body class="bg-gray-50">

<div id="player-container">
    <div id="xgplayer"></div>
    <div id="subtitle" class="bottom-20 text-white text-lg font-semibold"></div>

    <!-- MOBILE CONTROLS (TANPA DOWNLOAD & SHARE) -->
    <div class="mobile-controls-overlay flex flex-col gap-4 lg:hidden">
        <button id="openSubSettings" class="btn-custom-ply text-white">
            <i class="fas fa-cog"></i>
        </button>
        <button class="btn-custom-ply text-white openModal">
            <i class="fas fa-list-ul"></i>
        </button>
    </div>
</div>

<!-- SUBTITLE SETTINGS -->
<div id="subtitleSettingsModal" class="fixed inset-0 bg-black/80 hidden justify-center items-center z-50">
<div class="bg-white rounded-xl p-5 w-80">
<h2 class="font-bold mb-3">Subtitle</h2>

<label class="text-sm">Ukuran</label>
<input id="fontSize" type="range" min="12" max="40">

<label class="text-sm">Posisi</label>
<input id="posBottom" type="range" min="20" max="200">

<label class="text-sm">Opacity</label>
<input id="bgOpacity" type="range" min="0" max="1" step="0.1">

<button id="closeSub" class="mt-3 w-full bg-gray-200 py-1 rounded">Tutup</button>
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

let player=null;
const subtitle=document.getElementById("subtitle");

let sub={
    fontSize:18,
    bottom:80,
    bg:0.5
};

function applySub(){
    subtitle.style.fontSize=sub.fontSize+"px";
    subtitle.style.bottom=sub.bottom+"px";
}

function initPlayer(url,poster){
    if(player) player.destroy();
    player=new Player({
        id:"xgplayer",
        url:url,
        poster:poster,
        autoplay:true,
        muted:true,
        playsinline:true
    });
}

initPlayer("<%- playVoucher %>","<%- shortPlayCover %>");

/* SUBTITLE MODAL */
const modal=document.getElementById("subtitleSettingsModal");
document.getElementById("openSubSettings").onclick=()=>modal.classList.remove("hidden");
document.getElementById("closeSub").onclick=()=>modal.classList.add("hidden");

document.getElementById("fontSize").oninput=e=>{
    sub.fontSize=e.target.value;applySub();
};
document.getElementById("posBottom").oninput=e=>{
    sub.bottom=e.target.value;applySub();
};
document.getElementById("bgOpacity").oninput=e=>{
    sub.bg=e.target.value;
    subtitle.style.background=`rgba(0,0,0,${sub.bg})`;
};

});
</script>

</body>
</html>
